if (self.CavalryLogger) { CavalryLogger.start_js(["t7yQT"]); }

__d("LiveChatPluginMessageComposerAttachmentItem.react",["cx","ix","Image.react","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props.attachment;if(a.type.startsWith("image/"))return[i.jsx("div",{className:"_3l_i",style:{backgroundImage:a.thumbnail_url}},this.props.uploadID+"item"),i.jsx(b("ShimButton.react"),{className:"_3l_j _3l_k",onClick:this.props.removeAttachment},this.props.uploadID+"removeButton")];var c=i.jsx("div",{className:"_3l_l",style:{backgroundColor:this.props.threadColor},children:i.jsx(b("Image.react"),{src:a.type.startsWith("video/")?h("359148"):h("359146")})});a=a.name;var d=a.split(".").pop().toUpperCase();return i.jsxs("div",{className:"_3l_m",children:[c,i.jsxs("div",{className:"_3l_n",children:[i.jsx("div",{className:"_3l_o",children:d}),i.jsx("div",{className:"_3l_p",children:a})]}),i.jsx(b("ShimButton.react"),{className:"_3l_j _3l_q",onClick:this.props.removeAttachment})]})};return c}(i.PureComponent);e.exports=a}),null);
__d("LiveChatPluginMessageComposerAttachmentShelf.react",["cx","fbt","LiveChatPluginAttachmentUploadError","LiveChatPluginMessageComposerAttachmentItem.react","React","XUISpinner.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){b=a.call(this,b)||this;b.$1=new Map();return b}var d=c.prototype;d.render=function(){var a=this;if(this.props.attachments.size===0&&this.props.error===b("LiveChatPluginAttachmentUploadError").NO_ERROR)return null;this.props.attachments.forEach(function(b,c){a.$1.has(c)||a.$1.set(c,b)});this.$1.forEach(function(b,c){a.props.attachments.has(c)||a.$1["delete"](c)});var c=Array.from(this.$1).map(function(c){var d=c[0];c=c[1];return i.jsxs("div",{className:"_1i5v",children:[i.jsx(b("LiveChatPluginMessageComposerAttachmentItem.react"),{attachment:c,removeAttachment:function(){a.props.removeAttachment(d)},threadColor:a.props.threadColor,uploadID:d}),a.props.uploadingAttachments.has(d)?i.jsx(b("XUISpinner.react"),{className:"_1i63",background:"dark",size:"large"}):null]},d)});return i.jsxs("div",{className:"_1i69",children:[this.$2(),i.jsx("div",{className:"_2l9u",children:c})]})};d.$2=function(){var a;switch(this.props.error){case b("LiveChatPluginAttachmentUploadError").EXCEEDED_MAX_FILES:a=h._("Upload no more than 5 files at once. Please try again.");break;case b("LiveChatPluginAttachmentUploadError").EXCEEDED_FILE_MAX_SIZE:a=h._("This file exceeds the size limit of 25MB.");break;case b("LiveChatPluginAttachmentUploadError").UPLOAD_FAILED:a=h._("This file couldn't be uploaded. Please try again.");break;case b("LiveChatPluginAttachmentUploadError").NO_ERROR:default:return null}return i.jsx("div",{className:"_2l9v",children:a})};return c}(i.PureComponent);e.exports=a}),null);
__d("MPNBlockedPageComposer.react",["cx","fbt","MessagingPluginContext","MessagingPluginThreadActions","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";e.exports=a;var i=b("React");function a(){var a=i.useContext(b("MessagingPluginContext"));return i.jsx("div",{className:"_94wl",children:i.jsxs("div",{className:"_94wm",children:[i.jsx("div",{children:h._("Du har inaktiverat meddelanden f\u00f6r {pageName}",[h._param("pageName",a.state.pageName)])}),h._("Du kan inte skicka meddelande till dem och du kommer inte att ta emot n\u00e5got meddelande fr\u00e5n dem."),i.jsx(b("ShimButton.react"),{className:"_94wo",onClick:function(){b("MessagingPluginThreadActions").blockOrUnblockPage(a)},children:i.jsx("div",{className:"_94wp",children:h._("Aktivera meddelanden")})})]})})}}),null);
__d("XMNLiveChatPluginFileUploadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/plugins/live_chat/upload/",{})}),null);
__d("LiveChatPluginAttachmentUploadClient",["FileForm","LiveChatPluginAttachmentUploadError","LiveChatPluginLoggerUtil","MercuryConstants","PhotosUploadID","SubscriptionsHandler","XMNLiveChatPluginFileUploadController","cssURL"],(function(a,b,c,d,e,f){"use strict";var g=5;a=function(){function a(a,c,d,e){var f=this;this.$14=function(a,b){((a=b)!=null?(a=a.response)!=null?(a=a.payload)!=null?a.result:a:a:a)==="success"?f.$22(b):f.$23(b)};this.$1=new Map();this.$2=new Map();this.$3=new Map();this.$4=new Map();this.$5=d;this.$6=c;this.$7=new(b("SubscriptionsHandler"))();this.$8=a;this.$9=new Set();this.$10=new Map();this.$11=e}var c=a.prototype;c.onSubmitFileList=function(a){this.$6(b("LiveChatPluginAttachmentUploadError").NO_ERROR);var c=this.$12();c=this.$13(c);this.$7.addSubscriptions(c.subscribe("success",this.$14));if(a){if(a.length+this.$2.size>g){this.$6(b("LiveChatPluginAttachmentUploadError").EXCEEDED_MAX_FILES);b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_failed",this.$11,this.$5,JSON.stringify({error:"exceeded_max_files"}));return}var d={};for(var e=0;e<a.length;e++){var f=a[e];if(f.size>b("MercuryConstants").AttachmentMaxSize){this.$6(b("LiveChatPluginAttachmentUploadError").EXCEEDED_FILE_MAX_SIZE);b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_failed",this.$11,this.$5,JSON.stringify({error:"exceeded_max_file_size"}));return}var h=this.$15();d[h]=f;this.$9.add(h);this.$2.set(h,{name:f.name,thumbnail_url:b("cssURL")(window.URL.createObjectURL(f)),type:f.type});b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_submitted",this.$11,this.$5,JSON.stringify({uploadID:h}))}c.setFiles(d);c.forceSendViaXHR()}this.$8(this.$16(),this.$17())};c.removeAttachment=function(a){this.$9["delete"](a),this.$1["delete"](a),this.$2["delete"](a),this.$4["delete"](a),this.$3["delete"](a),this.$10["delete"](a),this.$8(this.$16(),this.$17(),this.$18(),this.$19(),this.$20(),this.$21()),b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_removed",this.$11,this.$5,JSON.stringify({uploadID:a}))};c.removeAllAttachments=function(){this.$1=new Map(),this.$2=new Map(),this.$3=new Map(),this.$4=new Map(),this.$9=new Set(),this.$10=new Map(),this.$8(this.$16(),this.$17(),this.$18(),this.$19(),this.$20(),this.$21())};c.$22=function(a){var c=a.response.payload;a=a.upload.getName();c=c.metadata[0];this.$9.has(a)&&(this.$9["delete"](a),c.image_id?this.$4.set(a,c.image_id):c.gif_id?this.$1.set(a,c.gif_id):c.video_id?this.$10.set(a,c.video_id):this.$3.set(a,c.file_id),this.$8(this.$16(),this.$17()),b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_completed",this.$11,this.$5,JSON.stringify({uploadID:a})));this.$24()||this.$8(this.$16(),this.$17(),this.$18(),this.$19(),this.$20(),this.$21())};c.$23=function(a){this.removeAttachment(a.upload.getName()),this.$6(b("LiveChatPluginAttachmentUploadError").UPLOAD_FAILED),b("LiveChatPluginLoggerUtil").logAction("customer_chat_attachment_upload_failed",this.$11,this.$5,JSON.stringify({error:"upload_failed"}))};c.$20=function(){return this.$4.size===0?[]:Array.from(this.$4.values())};c.$18=function(){return this.$1.size===0?[]:Array.from(this.$1.values())};c.$21=function(){return this.$10.size===0?[]:Array.from(this.$10.values())};c.$19=function(){return this.$3.size===0?[]:Array.from(this.$3.values())};c.$24=function(){return this.$9.size!==0};c.$16=function(){return this.$2};c.$17=function(){return this.$9};c.$12=function(){var a=document.createElement("form");a.action=b("XMNLiveChatPluginFileUploadController").getURIBuilder().getURI().toString();a.method="post";return a};c.$13=function(a){a=new(b("FileForm"))(a);a.setAllowCrossOrigin(!0);a.setUploadInParallel(!0);return a};c.$15=function(){return"upload_"+b("PhotosUploadID").getNewID()};c.destroy=function(){this.$7.release(),delete this.$7};return a}();e.exports=a}),null);
__d("MPNDesktopAttachmentInput.react",["cx","InlineBlock.react","LiveChatPluginAttachmentUploadClient","LiveChatPluginLoggerUtil","MessagingPluginContext","MPNPaperclipIconSVG.react","React"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.$2=function(){var a=d.context.state.pageID;b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",d.props.viewerID,a,"logged_in_chat_tab",{action_type:"customer_chat_attachment_button_clicked"})},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){this.$1=new(b("LiveChatPluginAttachmentUploadClient"))(this.props.updateComposerAttachmentsAndIDs,this.props.setComposerAttachmentError,this.props.pageID,this.props.viewerID)};d.componentWillUnmount=function(){this.$1.destroy()};d.render=function(){var a=this;return h.jsxs(b("InlineBlock.react"),{className:"_95jj",onClick:this.$2,children:[h.jsx("input",{accept:"application/msword, application/pdf, text/csv, text/plain, image/*, video/*",className:"_94vw",multiple:!0,name:"attachment[]",onChange:function(b){a.$3(b)},ref:"fileInput",title:"Add Files",type:"file"}),h.jsx(b("MPNPaperclipIconSVG.react"),{color:this.context.state.threadCSSColor})]})};d.$3=function(a){this.$1.onSubmitFileList(a.target.files),a.target.value=""};d.removeAttachment=function(a){this.$1.removeAttachment(a)};d.removeAllAttachments=function(){this.$1.removeAllAttachments()};return c}(h.PureComponent);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopBotMenuDialog.react",["cx","CometMenu.react","CometMenuItem.react","LiveChatPluginLoggerUtil","MercuryIDs","MessagingPluginContext","MNCommercePostbackCTADataManager","MPNIdentity","React","URI"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d){c=a.call(this,c,d)||this;c.state={navigationPath:[]};c.$1=b("LiveChatPluginLoggerUtil").getAttributionTags();c.$2=b("MercuryIDs").getThreadIDFromUserID(c.context.state.pageID);return c}var d=c.prototype;d.render=function(){var a=this,c=[],d=this.props.menuItems;for(var e=0;e<this.state.navigationPath.length;e++){var f=this.state.navigationPath[e];d!=null&&(d=d[f].nested_ctas)}d&&d.map(function(d,b){switch(d.action_type){case 4:a.$3(d,c);break;case 2:a.$4(d,c);break;case 11:a.$5(d,b,c);break;default:c.push({menuItemProps:{primaryText:d.title||""}});break}});return i.jsx("div",{className:"_968x",children:i.jsx(b("CometMenu.react"),{size:"full",withArrow:!0,children:c.map(function(c,a){return i.createElement(b("CometMenuItem.react"),babelHelpers["extends"]({},c.menuItemProps,{key:a}))})})})};d.$4=function(a,c){var d=this.context.state.pageID,e=function(c){(h||(h=b("URI"))).goURIOnNewWindow(a.action_link||"");c=b("MPNIdentity").MPNIdentity.currentUserID();b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",c,d,b("MPNIdentity").MPNIdentity.currentUserState()===b("MPNIdentity").MPNIdentityState.FB?"logged_in_chat_tab":"guest_chat_tab",{action_type:"customer_chat_bot_menu_url_redirect_clicked"})};c.push({menuItemProps:{onClick:e,primaryText:a.title||""}})};d.$5=function(a,b,c){var d=this,e=function(a){d.setState(function(a){return{navigationPath:a.navigationPath.concat(b)}})};c.push({menuItemProps:{onClick:e,primaryText:a.title||""}})};d.$3=function(a,c){var d=this,e=this.context.state.pageID,f=function(c){c=b("MPNIdentity").MPNIdentity.currentUserState();switch(c){case b("MPNIdentity").MPNIdentityState.FB:b("MNCommercePostbackCTADataManager").sendAndConfirm(a.id,a.title||"",d.$2,null,null,null,d.$1,null,null,"source:discovery:customer_chat_plugin");break;case b("MPNIdentity").MPNIdentityState.GUEST:var f=d.context.state.messageStore;f=f.sendQueue;if(!f)return;f.enqueueAndSend(a.title||"",f.makePlatformTokenForPostbackCTA(a.id));break;default:return}f=b("MPNIdentity").MPNIdentity.currentUserID();b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",f,e,c===b("MPNIdentity").MPNIdentityState.FB?"logged_in_chat_tab":"guest_chat_tab",{action_type:"customer_chat_bot_menu_postback_clicked"})};c.push({menuItemProps:{onClick:f,primaryText:a.title||""}})};return c}(i.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopBotMenuButton.react",["cx","fbt","AsyncRequest","BasePopoverTrigger.react","CometPressable.react","LiveChatPluginConstants","LiveChatPluginGuestPersistentMenuQuery","LiveChatPluginLoggerUtil","LiveChatPluginSendButtonSVG.react","MessagingPluginContext","MPNBotMenuButtonSVG.react","MPNDesktopBotMenuDialog.react","MPNIdentity","MPNLocalState","MPNStorage","React","XMessengerBotsMenuController"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={menuItems:null},c.$4=function(){c.setState(c.$3(!0)),c.props.onClick()},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.UNSAFE_componentWillMount=function(){this.state.menuItems==null&&this.$2()};d.componentDidUpdate=function(){this.state.menuItems==null&&this.context.state.accessToken&&this.$2()};d.componentWillUnmount=function(){this.$1&&(this.$1.abort(),this.$1=null),this.setState(this.$3(!1))};d.render=function(){var a=this,c=this.context.state,d=c.isComposerDisabled,e=c.hasPersistentMenu,f=c.threadCSSColor;return!d&&(!e||!this.state.menuItems)?i.jsx("div",{className:" _95jk _95ms",children:i.jsx(b("LiveChatPluginSendButtonSVG.react"),{threadColor:b("LiveChatPluginConstants").GUEST_SEND_BUTTON_COLOR_EMPTY_INPUT})}):i.jsx(b("BasePopoverTrigger.react"),{autoAlign:!0,popover:b("MPNDesktopBotMenuDialog.react"),popoverProps:{menuItems:this.state.menuItems},children:function(c,d){return i.jsx("div",{ref:c,children:i.jsx("div",{className:"_94vq",children:i.jsx(b("CometPressable.react"),{overlayRadius:50,"aria-label":h._("Fast meny"),onPress:(a.$4,d),children:i.jsx(b("MPNBotMenuButtonSVG.react"),{threadColor:f})})})})}})};d.$2=function(){var a=this,c=this.context,d=c.state,e=c.dispatchAction;c=d.pageID;d=b("MPNStorage").getFBStorageState();if(!d||d.chatState===b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED)return;d=b("MPNIdentity").MPNIdentity.currentUserState();switch(d){case b("MPNIdentity").MPNIdentityState.GUEST:d=(d=b("MPNIdentity").MPNIdentity.currentUser())==null?void 0:d.accessToken;if(d==null)return;b("LiveChatPluginGuestPersistentMenuQuery").fetch(c,d,function(b){b!=null&&b.length>0?(a.setState({menuItems:b}),e({type:"TOGGLE_HAS_PERSISTENT_MENU",hasPersistentMenu:!0})):(a.setState({menuItems:[]}),e({type:"TOGGLE_HAS_PERSISTENT_MENU",hasPersistentMenu:!1}))});break;case b("MPNIdentity").MPNIdentityState.FB:d=b("XMessengerBotsMenuController").getURIBuilder().setString("page_id",c).setBool("should_flatten",!0).getURI();this.$1=new(b("AsyncRequest"))().setURI(d).setHandler(function(b){a.setState({menuItems:b.payload.menu})}).setErrorHandler(function(b){a.setState({menuItems:[]})});this.$1.send();break;default:return}};d.$3=function(a){var c=this.context.state.pageID,d=b("MPNIdentity").MPNIdentity.currentUserID();b("LiveChatPluginLoggerUtil").logActionFromNewUI("in_thread_action",d,c,b("MPNIdentity").MPNIdentity.currentUserState()===b("MPNIdentity").MPNIdentityState.FB?"logged_in_chat_tab":"guest_chat_tab",{action_type:a?"customer_chat_bot_menu_opened":"customer_chat_bot_menu_closed"})};return c}(i.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopGuestAttachmentButton.react",["cx","MessagingPluginContext","MPNConstants","MPNPaperclipIconSVG.react","MPNStorage","React","ShimButton.react"],(function(a,b,c,d,e,f,g){"use strict";var h=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.context.dispatchAction;return h.jsx(b("ShimButton.react"),{"data-testid":void 0,className:"_95jj",onClick:function(){b("MPNStorage").setShowUpgradePrompt(b("MPNConstants").MPNUpgradePrompt.ATTACHMENT_UPSELL),a({type:"UPDATE_UPGRADE_UPSELL_PROMPT",upgradeUpsellPrompt:b("MPNConstants").MPNUpgradePrompt.ATTACHMENT_UPSELL})},children:h.jsx(b("MPNPaperclipIconSVG.react"),{color:this.context.state.threadCSSColor})})};return c}(h.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopGuestUpgradeUpsellPrompt.react",["ix","cx","fbt","Arbiter","CometPressable.react","Image.react","LiveChatPluginLoggerUtil","LiveChatPluginPromptButton.react","MessagingPluginContext","MessagingPluginThreadActions","MPNConstants","MPNGuestUpgradeFBTStrings","MPNStorage","React","asset"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.$1=null,b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.componentWillUnmount=function(){this.$1&&b("Arbiter").unsubscribe(this.$1)};d.componentDidMount=function(){var a=this.context.state,c=a.pageID;a=a.guestID;b("LiveChatPluginLoggerUtil").logImpressionFromNewUI("tab_impression",c,"upgrade_prompt",null,null,null,null,null,a,{prompt_type:this.props.prompt})};d.render=function(){var a=this,c=this.props.prompt,d=b("MPNGuestUpgradeFBTStrings").getPromptTitle(c,this.context),e=b("MPNGuestUpgradeFBTStrings").getPromptSubtitle(c,this.context),f=c===b("MPNConstants").MPNUpgradePrompt.DONT_WAIT_FOR_REPLY_UPSELL;return j.jsxs("div",{className:"_95to"+(f?"":" _9aqp"),children:[j.jsxs("div",{className:"promptHeaderContainer",children:[j.jsx("div",{className:"_95tx",children:j.jsx(b("Image.react"),{className:"messengerIcon",src:g("1273954")})}),j.jsxs("div",{className:"_95tr",children:[j.jsx("div",{className:"_95ty",children:d}),j.jsx("div",{className:"_95tz",children:e})]}),f&&j.jsx("div",{className:"_9aqq _95lg",children:j.jsx(b("CometPressable.react"),{"aria-label":i._("St\u00e4ng"),onPress:function(){b("MPNStorage").setShowUpgradePrompt(b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN),a.$2()},overlayRadius:50,children:j.jsx(b("Image.react"),{src:g("478231")})})})]}),j.jsx("div",{className:"promptFooterContainer",children:f?j.jsx("div",{className:"continueButton",children:j.jsx(b("LiveChatPluginPromptButton.react"),{color:this.props.color,hasIcon:!1,onClick:function(){a.$1=b("MessagingPluginThreadActions").launchUpgradeFlowDesktop(a.context,a.props.history,c),a.$3()},text:i._("Forts\u00e4tt i Messenger")})}):j.jsxs(j.Fragment,{children:[j.jsx("div",{className:"dismissButton footerButton",children:j.jsx(b("LiveChatPluginPromptButton.react"),{color:"rgba(0, 0, 0, .05)",hasIcon:!1,onClick:function(){b("MPNStorage").setShowUpgradePrompt(b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN),a.$2()},text:i._("Inte nu")})}),j.jsx("div",{className:"continueButton footerButton",children:j.jsx(b("LiveChatPluginPromptButton.react"),{color:this.props.color,hasIcon:!0,onClick:function(){a.$1=b("MessagingPluginThreadActions").launchUpgradeFlowDesktop(a.context,a.props.history,c),a.$3()},text:i._("Forts\u00e4tt")})})]})})]})};d.$3=function(){var a=this.context.state,c=a.guestID;a=a.pageID;b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",c,a,"upgrade_prompt",{button_name:"upgrade_prompt_continue",prompt_type:this.props.prompt})};d.$2=function(){var a=this.context,c=a.dispatchAction;a=a.state;var d=a.guestID;a=a.pageID;c({type:"UPDATE_UPGRADE_UPSELL_PROMPT",upgradeUpsellPrompt:b("MPNConstants").MPNUpgradePrompt.NOT_SHOWN});b("LiveChatPluginLoggerUtil").logActionFromNewUI("tab_click",d,a,"upgrade_prompt",{button_name:"upgrade_prompt_not_now",prompt_type:this.props.prompt})};return c}(j.Component);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopMessageComposer.react",["cx","fbt","AbstractTextInput.react","Keys","LiveChatPluginAttachmentUploadError","LiveChatPluginLoggerUtil","LiveChatPluginMessageComposerAttachmentShelf.react","LiveChatPluginSendButtonSVG.react","MercuryIDs","MercuryMessageActions","MercuryMessageObject","MessagingPluginContext","MPNDesktopAttachmentInput.react","MPNDesktopBotMenuButton.react","MPNDesktopGuestAttachmentButton.react","MPNIdentity","MPNLocalState","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";var i=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d){var e;e=a.call(this,c,d)||this;e.state={attachmentsDataMap:new Map(),error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,inputValue:"",uploadingAttachments:new Set()};e.$19=function(a){e.props.onChange(),e.setState({error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,inputValue:a.target.value})};e.$20=function(a){a.keyCode===b("Keys").RETURN&&(a.preventDefault(),e.$18())};e.$18=function(){var a=b("MPNIdentity").MPNIdentity.currentUserState();a===b("MPNIdentity").MPNIdentityState.FB?e.$21():a===b("MPNIdentity").MPNIdentityState.GUEST&&e.$22()};e.$11=function(a){e.$2&&e.$2.removeAttachment(a)};e.$15=function(a){e.setState({error:a})};e.$16=function(a,c,d,f,g,h){d&&(e.$1=d),f&&(e.$3=f),g&&(e.$4=g),h&&(e.$10=h),e.setState({attachmentsDataMap:new Map(a),error:b("LiveChatPluginAttachmentUploadError").NO_ERROR,uploadingAttachments:new Set(c)}),e.focus()};c=e.context.state.pageID;d=b("MPNIdentity").MPNIdentity.currentUserID();if(d==null)return babelHelpers.assertThisInitialized(e);e.$6=b("MercuryMessageActions").getForFBID(d);e.$7=b("MercuryMessageObject").getForFBID(d);e.$8=b("MercuryIDs").getThreadIDFromUserID(c);e.$9=b("LiveChatPluginLoggerUtil").getAttributionTags();e.$1=[];e.$3=[];e.$4=[];e.$10=[];return e}var d=c.prototype;d.render=function(){return i.jsxs("div",{className:(this.context.state.isComposerDisabled?"_664i":"")+" _94vs",children:[i.jsx(b("LiveChatPluginMessageComposerAttachmentShelf.react"),{attachments:this.state.attachmentsDataMap,error:this.state.error,removeAttachment:this.$11,threadColor:this.context.state.threadColor,uploadingAttachments:this.state.uploadingAttachments}),i.jsxs("div",{className:"_94vt",children:[this.$12(),this.$13(),this.$14()]})]})};d.$12=function(){var a=this,c=this.context.state,d=c.isComposerDisabled,e=c.optimisticStorageState;c=c.showUpgradeUpsellPrompt;if(d||e.chatState===b("MPNLocalState").MPNChatState.CHAT_NOT_STARTED)return null;if(b("MPNIdentity").MPNIdentity.currentUserState()===b("MPNIdentity").MPNIdentityState.GUEST)if(c===!0)return i.jsx(b("MPNDesktopGuestAttachmentButton.react"),{threadColor:this.context.state.threadCSSColor});else return null;d=b("MPNIdentity").MPNIdentity.currentUserID();return d==null?null:i.jsx(b("MPNDesktopAttachmentInput.react"),{pageID:this.context.state.pageID,ref:function(b){a.$2=b},setComposerAttachmentError:this.$15,updateComposerAttachmentsAndIDs:this.$16,viewerID:d})};d.$14=function(){var a=this.context.state,c=a.isComposerDisabled;a=a.threadCSSColor;var d=this.state.inputValue.length===0&&this.state.attachmentsDataMap.size===0;return d||c?this.$17():i.jsx(b("ShimButton.react"),{"aria-label":h._("Skicka"),className:"_4bqf _95jk","data-testid":void 0,onClick:this.$18,children:i.jsx(b("LiveChatPluginSendButtonSVG.react"),{threadColor:a})})};d.$13=function(){var a=this,c=this.context.state,d=c.pageName;c=c.isComposerDisabled;return c?i.jsx("div",{className:"_664k",children:h._("{page name} har inaktiverat skrivande.",[h._param("page name",d)])}):i.jsx("div",{className:"_94vv",children:i.jsx(b("AbstractTextInput.react"),{"data-testid":void 0,onBlur:this.props.onBlur,onChange:this.$19,onClick:this.props.onClick,onFocus:this.props.onFocus,onKeyDown:this.$20,ref:function(b){a.$5=b},placeholder:h._("St\u00e4ll en fr\u00e5ga ...").toString(),value:this.state.inputValue})})};d.$17=function(){return i.jsx(b("MPNDesktopBotMenuButton.react"),{onClick:this.props.onClick})};d.$22=function(){var a=this.context.state;if(!a.messageStore||!a.messageStore.sendQueue)return;var c=a.messageStore.sendQueue,d=this.state.inputValue.trim();d&&d.length>0&&c.enqueueAndSend(d,null);this.setState({inputValue:""});b("LiveChatPluginLoggerUtil").logActionFromNewUI("message_send",a.guestID,a.pageID,"guest_chat_tab")};d.$21=function(){var a=this.context.state.pageID,c=b("MPNIdentity").MPNIdentity.currentUserID();if(this.state.uploadingAttachments.size!==0)return;var d=this.state.inputValue.trim();if(d&&d.length>0||this.state.attachmentsDataMap.size>0){d=this.$7.constructUserGeneratedMessageObject(d,"source:discovery:customer_chat_plugin",this.$8,null,null,this.$9);this.$4.length>0&&(d.has_attachment=!0,d.image_ids=this.$4);this.$1.length>0&&(d.has_attachment=!0,d.gif_ids=this.$1);this.$10.length>0&&(d.has_attachment=!0,d.video_ids=this.$10);this.$3.length>0&&(d.has_attachment=!0,d.file_ids=this.$3);this.$6.send(d);this.setState({inputValue:""});this.$23();b("LiveChatPluginLoggerUtil").logActionDEPRECATED("message_sent",c,a,this.state.attachmentsDataMap.size>0?JSON.stringify({attachments:Array.from(this.state.attachmentsDataMap.keys())}):null);b("LiveChatPluginLoggerUtil").logAction("customer_chat_message_sent",c,a,this.state.attachmentsDataMap.size>0?JSON.stringify({attachments:Array.from(this.state.attachmentsDataMap.keys())}):null);b("LiveChatPluginLoggerUtil").logActionFromNewUI("message_send",c,a,"logged_in_chat_tab")}};d.$23=function(){this.$2&&this.$2.removeAllAttachments()};d.focus=function(){this.$5&&this.$5.focusInput()};return c}(i.PureComponent);e.exports=a;a.contextType=b("MessagingPluginContext")}),null);
__d("MPNDesktopThreadPageContent.react",["cx","LiveChatPluginLoggerUtil","MessagingPluginContext","MessagingPluginDialogBody.react","MessengerState.bs","MPNBlockedPageComposer.react","MPNConstants","MPNDesktopDialogHeader.react","MPNDesktopGuestUpgradeUpsellPrompt.react","MPNDesktopMessageComposer.react","MPNEndChatPrompt.react","MPNIdentity","MPNLocalState","React","UnverifiedXD","emptyFunction"],(function(a,b,c,d,e,f,g){"use strict";var h=b("MessengerState.bs").jsComponent,i=b("MPNConstants").MPNUpgradePrompt,j=b("MPNIdentity").MPNIdentity,k=b("MPNIdentity").MPNIdentityState,l=b("MPNLocalState").MPNChatState,m=b("React");a=function(a){babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.state={dialogBodyHeight:-1},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.render=function(){var a=this,c=this.context.state,d=c.optimisticStorageState,e=c.pageID,f=c.isPageBlocked;c=c.showUpgradeUpsellPrompt;var g=j.currentUserID(),n=j.currentUserState()===k.GUEST;try{return m.jsx("div",{role:"none",className:"_94vg",children:m.jsxs("div",{className:"_9eny",children:[m.jsx(b("MPNDesktopDialogHeader.react"),{ActionDelegate:this.props.ActionDelegate,history:this.props.history}),m.jsx("div",{className:"_424s",children:d.chatState!==l.CHAT_NOT_STARTED&&m.jsx(h,{fbid:g,children:function(c){return m.jsx(b("MessagingPluginDialogBody.react"),{deliveryReceipt:b("MessengerState.bs").deliveryReceipts(c),dialogBodyHeight:a.state.dialogBodyHeight,messengerState:c,readReceipt:null,sendRef:function(){}})}})}),d.showUpgradePrompt==null||d.showUpgradePrompt===i.NOT_SHOWN||d.showUpgradePrompt===i.UNSAVED_MSG_UPSELL&&this.context.state.messageCount==null||!c?null:m.jsx(b("MPNDesktopGuestUpgradeUpsellPrompt.react"),{color:this.context.state.threadCSSColor,prompt:this.context.state.optimisticStorageState.showUpgradePrompt,history:this.props.history}),m.jsx(b("MPNEndChatPrompt.react"),{isGuest:n,history:this.props.history,shouldMinimize:!1}),f&&d.chatState===l.LOGGED_IN_CHAT_STARTED?m.jsx(b("MPNBlockedPageComposer.react"),{}):m.jsx(b("MPNDesktopMessageComposer.react"),{onBlur:this.$2()?this.$3:b("emptyFunction"),onChange:function(){},onClick:function(){},onFocus:this.$2()?this.$4:b("emptyFunction"),ref:function(b){return a.$1=b}})]},"dialog_container")})}catch(a){b("LiveChatPluginLoggerUtil").logImpressionExceptionsFromNewUI("tab_load_failure",e,j.currentUserState()===k.FB?"logged_in_chat_tab":"guest_chat_tab",a.name,a.message,a.stack)}};d.$2=function(){return/iPhone|iPad|iPod/.test(navigator.userAgent)};d.$4=function(){b("UnverifiedXD").send({type:"liveChatPluginFocusComposer"})};d.$3=function(){b("UnverifiedXD").send({type:"liveChatPluginBlurComposer"})};return c}(m.Component);a.contextType=b("MessagingPluginContext");e.exports=a}),null);